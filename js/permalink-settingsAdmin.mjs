(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".form-error[data-v-99e32e74]{color:#c40c0c;display:block}.status-icon[data-v-99e32e74]{margin-left:6px}[data-v-99e32e74] input#permalink-api-endpoint,[data-v-99e32e74] input#jwt-secret-key{width:300px!important}.input-with-icon[data-v-99e32e74]{display:flex;align-items:center}.input-with-icon .status-icon[data-v-99e32e74]{margin-bottom:10px;display:flex;align-items:center}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
/*! third party licenses: js/vendor.LICENSE.txt */
import{n as p,c as l,_ as c,t as r,V as d,C as g,N as u,a as m,b as S,s as o,d as h}from"./style-8HsC40oc.chunk.mjs";const k={name:"AlertCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var y=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon alert-circle-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(i){return t.$emit("click",i)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},w=[],v=p(k,y,w,!1,null,null);const A=v.exports;var a=(t=>(t.JwtSecretKey="jwt_secret_key",t.PermalinkApiEndpoint="permalink_api_endpoint",t))(a||{}),n=(t=>(t[t.Idle=0]="Idle",t[t.Updating=1]="Updating",t[t.Completed=2]="Completed",t[t.Error=3]="Error",t))(n||{});const C={data(){return{settings:null}},methods:{async fetchSettings(){try{const t=await l.get(c("/apps/permalink/settings"));t.data&&(this.settings=t.data)}catch(t){console.error(t.response)}},async getSettings(){return this.settings?this.settings:(await this.fetchSettings(),this.settings)},async getJwtSecret(){const t=await this.getSettings();return t&&t.jwtSecretKey?t.jwtSecretKey:""},async getPermalinkApiEndpoint(){const t=await this.getSettings();return t&&t.permalinkApiEndpoint?t.permalinkApiEndpoint:""}}},f={name:"AdminSettings",components:{NcSettingsSection:S,NcSettingsInputText:m,NcLoadingIcon:u,CheckIcon:g,AlertIcon:A},directives:{Tooltip:d},mixins:[C],data(){return{updating:{status:n.Idle,key:null},loading:!0,jwtSecretKey:"",permalinkApiEndpoint:"",deleteConflicts:!1}},computed:{UpdateState(){return n},SettingsKey(){return a}},async mounted(){this.loading=!0,this.jwtSecretKey=await this.getJwtSecret(),this.permalinkApiEndpoint=await this.getPermalinkApiEndpoint(),this.loading=!1},methods:{t:r,setUpdate(t,e){this.updating.status=e,this.updating.key=t},async onSecretKeySubmit(){await this.saveSettings(a.JwtSecretKey,this.jwtSecretKey)},async onApiEndpointSubmit(){await this.saveSettings(a.PermalinkApiEndpoint,this.permalinkApiEndpoint)},async onDeleteConflictsChange(t){await this.saveSettings(a.DeleteRemovedShareConflicts,t?"1":"0")},async saveSettings(t,e){const i={key:t,value:e};this.setUpdate(t,n.Updating);try{await l.post(c("/apps/permalink/settings/save"),i),this.setUpdate(t,n.Completed)}catch(s){s.response.data&&s.response.data.message?o(r("permalink",s.response.data.message)):(o(r("permalink","Error occurred while saving settings")),console.error(s.response)),this.setUpdate(t,n.Error)}}}};var E=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"permalink-admin-settings"}},[e("NcSettingsSection",{attrs:{name:t.t("permalink","API Endpoint"),description:t.t("permalink","Base URL of the external Permalink API that handles link creation")}},[e("div",{staticClass:"input-with-icon"},[e("h3",[t.updating.key===t.SettingsKey.PermalinkApiEndpoint?e("span",{staticClass:"status-icon"},[t.updating.status===t.UpdateState.Updating?e("NcLoadingIcon",{attrs:{name:t.t("permalink","Saving..."),size:20}}):t.updating.status===t.UpdateState.Completed?e("CheckIcon",{attrs:{size:20}}):t.updating.status===t.UpdateState.Error?e("AlertIcon",{attrs:{size:20}}):t._e()],1):t._e()]),e("NcSettingsInputText",{attrs:{id:"permalink-api-endpoint",label:"",value:t.permalinkApiEndpoint,disabled:t.updating.status===t.UpdateState.Updating||t.loading},on:{"update:value":function(i){t.permalinkApiEndpoint=i},submit:t.onApiEndpointSubmit}})],1)]),e("NcSettingsSection",{attrs:{name:t.t("permalink","Jwt secret key"),description:t.t("permalink","Secret key used to sign JWT tokens for authenticating requests to the Permalink API. Must match the API's configuration")}},[e("div",{staticClass:"input-with-icon"},[e("h3",[t.updating.key===t.SettingsKey.JwtSecretKey?e("span",{staticClass:"status-icon"},[t.updating.status===t.UpdateState.Updating?e("NcLoadingIcon",{attrs:{name:t.t("permalink","Saving..."),size:20}}):t.updating.status===t.UpdateState.Completed?e("CheckIcon",{attrs:{size:20}}):t.updating.status===t.UpdateState.Error?e("AlertIcon",{attrs:{size:20}}):t._e()],1):t._e()]),e("NcSettingsInputText",{attrs:{id:"jwt-secret-key",label:"",value:t.jwtSecretKey,disabled:t.updating.status===t.UpdateState.Updating||t.loading},on:{"update:value":function(i){t.jwtSecretKey=i},submit:t.onSecretKeySubmit}})],1)])],1)},U=[],I=p(f,E,U,!1,null,"99e32e74");const _=I.exports;console.debug("Permalink: SettingsAdmin init");const b=h.extend(_);new b().$mount("#permalink-admin-settings");
//# sourceMappingURL=permalink-settingsAdmin.mjs.map
